Реализовать приложение, работающее в одноранговой P2P сети. 
===========================================================

Базовый функционал:
-------------------
1. Любой узел может принять на вход сообщение.
2. Узел должен разослать сообщение всем остальным узлам в сети.
3. Каждый узел хранит у себя историю сообщений.
4. Необходим алгоритм консенсуса (новый узел при включении в сеть должен синхронизироваться автоматически; при сбое в работе узла он должен понять, что произошел сбой и синхронизироваться с сетью)

Дополнительные сведения:
------------------------
Формат сериализации сообщений и протокол общения между узлами - на свой выбор, с обоснованием, почему выбраны конкретные решения. В рамках тестовой задачи можно считать, что узлы находятся в одном VLAN


Transaction flow:
-----------------

```
Client               Node                         Network
-------              -----                        -------
   |                   |                             |
   | Incoming message  |                             |
   |------------------>|                             |
   | Message accepted  |                             |
   |<------------------|                             |
   |                   |                             |   
   |                   | Start Transaction           |   
   |                   |---------------------------->|
   |                   |                             |
   |                   | Confirm Transaction Started |
   |                   |<----------------------------|
   |                   |                             |   
   |                   | Message Packet              |
   |                   |---------------------------->|
   |                   |                             |   
   |                   | Message Received            |
   |                   |<----------------------------|
   |                   |                             |   
   |                   | Commit                      |
   |                   |---------------------------->|
   
   
      
```

Synchronization flow:
---------------------

```
Node                         Network          Selected Node
-----                        -------          -------------
  |                             |                   |
  | Syncronization Request      |                   |
  |---------------------------->|                   |
  |                             |                   |
  | Versions responses          |                   |
  |<============================|                   |
  |                             |                   |
  | Select a node having max v  |                   |
  |---------+                   |                   |
  |         |                   |                   |
  |<--------+                   |                   |
  |                             |                   |
  | Get last DB request         |                   |
  |------------------------------------------------>|
  |                             |                   |
  | Last DB dat                 |                   |
  |<------------------------------------------------|
  |                             |                   |
  | Update local cache          |                   |
  |--------+                    |                   |
  |        |                    |                   |
  |<-------+                    |                   |
  |                             |                   |
  
```

Heartbeat:
----------

```
Node                         Network
-----                        -------
  |                             |
  | Ping broadcast (T=100ms)    |
  |---------------------------->|
  |                             |
    
Node                         Network
-----                        -------
  |                             |
  | Incoming Ping broadcast     |
  |<----------------------------|
  |                             |
  | Refresh nodelist            |
  |--------+                    |
  |        |                    |
  |<-------+                    |
  |                             |
  
```

Node state machine:
-------------------

```
+---------------+  Update   +-----------+                        +---------------+
|               |---------->|           |                   +--->|               |  
| InTransaction |           |  Updated  |                   |    | SendingUpdate |                      
|               |           |           |       UpdateMe    |    |               |                      
+---------------+           +-----------+                   |    +---------------+
    ^            Commit/Rollback | |                        |         |
    |                            | |  +---------------------+         | UpdateSent
    | Start transaction          | |  |                               |
    | received                   | |  | +-----------------------------+
    |                            V V  | V
    |                     +--------------+       Synchronize      +------------------+
    +---------------------|              |----------------------->|                  |
                          |  Connected   |       Synchronized     |  Synchronization |
    +---------------------|              |<-----------------------|                  |
    |                     +--------------+                        +------------------+
    |                          ^   ^
    | Incoming                 |   |                    Yield
    | message                  |   +--------------------------------------------------------+
    | received                 |       Commit                                               |
    |                          +---------------------------------+                          |
    V                                                            |                          |
+-------------------+  Start       +-------------+  Update  +----------+  Rollback  +---------------------+
|                   |------------->| Started     | -------->|          |----------->|                     |
|  IncomingReceived |  transaction | Transaction |          | Updating |            |  TransactionFailed  |
|                   |              |             |          |          |            |                     |
+-------------------+              +-------------+          +----------+            +---------------------+
  
```

Node state transitions:
-----------------------

| Сигнал | Состояние | Следующее состояние | Действие |
|--------|-----------|---------------------|----------|
| - | Connected | Connected | - |
| StartTransaction | Connected | InTranscaction | Старт транзакции, готовность к приёму апдейта |
| Update | StartTransaction | Updated | Обновление хранилища, отправка подтверждения |
| Commit | Updated | Connected | Фиксация состояния хранилища |
| Rollback | Updated | Connected | Откат изменений последнего обновления |
| IncomingMessage | Connected | IncomingReceived | Формирование обновления |
| StartTransaction | IncomingReceived | StartedTransaction | Отправка бродкаста о старте транзакции, ожидание подтверждений |
| Update | StartedTransaction | Updating | Отправка бродкаста с обновлением |
| Rollback | Updating | TransactionFailed | Отправка бродкаста с сигналом Rollback |
| Yield | TransactionFailed | Connected | Запланировать повторное обновление позже |
| Commit | Updating | Connected | Отправка бродкаста с сигналом Commit |
| UpdateMe | Connected | SendingUpdate | Отправка обновления по запросу |
| UpdateSent | SendingUpdate | Connected | - |
